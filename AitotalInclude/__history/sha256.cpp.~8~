//---------------------------------------------------------------------------
 #include "uSha256.hpp"
#pragma hdrstop

#include "sha256.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)

UnicodeString Mysha256(UnicodeString filename,UnicodeString &error)
{
	UnicodeString sha = "";
	error = "";
	if(FileExists(filename))
	{
	   TFileStream *fs = new TFileStream(filename, fmOpenRead | fmShareDenyNone);

	   try
	   {

			//f := ExpandFileName(filename);
			if(fs->Size >0)
			   sha = _GetSHA256(fs,fs->Size);
			else
			   error = "Ошибка рсчёта SHA256.3\n Имя файл = " + filename + ": Сообщение ошибки  = \"Размер FileStream < 0 \":";

	   }

	   catch(EFOpenError &E)
	   {
		   error = "Ошибка расчёта SHA256.\n Имя файл = " + filename + " Сообщение ошибки  = " + E.Message;
           return sha;
	   }
	   catch(Exception &E)
	   {
		   error = "Ошибка расчёта SHA256.\n Имя файл = " + filename + " Сообщение ошибки  = " + E.Message;
	   }

	   delete fs;
	}
	else
	{
		error = "name file = \"" + filename +"\"" +"\n nou file";
    }
	return sha;
}
