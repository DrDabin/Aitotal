//---------------------------------------------------------------------------
 #include "uSha256.hpp"
#pragma hdrstop

#include "sha256.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)

UnicodeString Mysha256(UnicodeString filename,UnicodeString &error)
{
	UnicodeString sha = "";
	error = "";
	if(FileExists(filename))
	{
	   TFileStream *fs;

	   try{
			fs = new TFileStream(filename, fmOpenRead | fmShareDenyWrite);
	   }
	   catch(Exception &E)
	   {
		   error = E.Message;
		   "Ошибка расчёта SHA256.\n Имя файл = " + filename + " Сообщение ошибки  = " + error;
	   }

	   //f := ExpandFileName(filename);
	   if(fs->Size >0)
		 sha = _GetSHA256(fs,fs->Size);
	   else
		  error = "Ошибка рсчёта SHA256.3\n Имя файл = " + filename + ": Сообщение ошибки  = \"Размер FileStream < 0 \":";
	   delete fs;
	}
	else
	{
		error = "\"" + filename +"\"" +"\n nou file";
    }
	return sha;
}
