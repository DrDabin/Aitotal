unit parsejsson;

interface
   uses
  {Winapi.Windows, System.SysUtils, System.Variants,} System.Classes, {Vcl.Graphics,}
  {Vcl.Controls,} {Vcl.StdCtrls,}ComCtrls ,System.JSON ;

 procedure ListView1ToJson(ListView1 :TListView);

implementation
//
procedure ListView1ToJson(ListView1 :TListView);
 var JSONObject, InnerObject : TJSONObject;
    JsonArray: TJSONArray;
    S:TStringList;
    I : integer;
begin
    JSONObject:=TJSONObject.Create;
    JsonArray :=TJSONArray.Create;
    S:=TStringList.Create;
    try

       for I :=0 to ListView1.Items.Count-1 do
       begin
         InnerObject:=TJSONObject.Create;
         InnerObject.AddPair('namefile',ListView1.Items[I].SubItems.Strings[0]);
         InnerObject.AddPair('filesize',ListView1.Items[I].SubItems.Strings[1]);
         InnerObject.AddPair('md5',ListView1.Items[I].SubItems.Strings[2]);
         InnerObject.AddPair('sha256',ListView1.Items[I].SubItems.Strings[3]);
         JsonArray.AddElement(InnerObject);

       end;
       JSONObject.AddPair('tablica1',JsonArray);

       S.Add(JSONObject.ToJSON);
       s.SaveToFile('jsson.txt');

    finally
       s.Destroy;
       JSONObject.Destroy;
    end;


end;


end.
