//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "paroll1.h"
#include "Aitotal1.h"
#include "AitotalInclude/archiv/extract.h"
//---------------------------------------------------------------------------
#pragma resource "*.dfm"
TFParoll *FParoll;
//---------------------------------------------------------------------------
__fastcall TFParoll::TFParoll(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TFParoll::BtOkClick(TObject *Sender)
{
	if(EdParoll->Text != "")
	{
		switch(extArchivToPassword(NameArchiv.w_str(), Dir.w_str(), EdParoll->Text.w_str(), GuidArchiv))
		{
			case EX_OK:
				Form3->Mapasswor = true;
				pass = true;
				FParoll->Close();
				break;
			case errorDataPass:
				EdParoll->Text = "";
				break;

			case errorHead:
				ShowMessage("Ошибка. Архив поврежден.");
				FParoll->Close();
				break;
		}
	}
}
//---------------------------------------------------------------------------
