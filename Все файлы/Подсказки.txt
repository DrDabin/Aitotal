IndyVT->ReadTimeout = 30000;
   //если будут ошибки с ssl то раскоментировать и попробовать.
   //IndyVT->ConnectTimeout = 30000;


Место определения настроек прокси.
//******************************************* 
Перем ПроксиЕсть;
Перем ПроксиАдресПорт;

Процедура Сформировать()
    ПроксиЕсть = "";
    ПроксиАдресПорт = "";
    shell = CreateObject("WScript.shell");
    ПроксиЕсть = shell.RegRead("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyEnable");
    Если ПроксиЕсть = 1 Тогда
        ПроксиАдресПорт = shell.RegRead("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer");
    КонецЕсли;
    Сообщить(?(ПроксиЕсть = 1,"Прокси ВКЛ","Прокси ВЫКЛ"));
    Сообщить("Адрес:порт прокси : " + СокрЛП(ПроксиАдресПорт));
КонецПроцедуры //Сформировать 
//**********************************
// поиск всех файлов с рекурсией
#include <System.IOUtils.hpp>
 
TStringDynArray Files;
String Dir= EditDir->Text;
String Mask= EditMask->Text; //  "*.txt"
 
Files = TDirectory::GetFiles(Dir, Mask, TSearchOption::soAllDirectories );
 
for(int i=0; i<Files.Length; ++i)
   ListBoxFiles->Items->Add(Files[i]);


void __fastcall TForm1::Button1Click(TObject *Sender)
{
	 TStringDynArray Files;
String Dir= "D:\\Embarcadero RAD Studio XE4 Upd 1";
String Mask= "*"; //  "*.txt"

Files = TDirectory::GetFiles(Dir, Mask ,TSearchOption::soAllDirectories );

for(int i=0; i<Files.Length; ++i)
{
   RichEdit1->Lines->Add(Files[i]);
   //папки всегда возвращает 16 а файлы 32
   RichEdit1->Lines->Add(GetFileAttributesA("D:\\Embarcadero RAD Studio XE4 Upd 1\\02.xe4_bds.exe_patch.exe"));
}
}
//---------------------------------------------------------------------------
// разбиение строки по символу ,
// когда результат буду
#include <StrUtils.hpp>
 
    String s = L"г. Новосибирск, ул. 1905 г., д. 15, кв. 123";
    TStringDynArray arr(SplitString(s, ","));

//************************************
Вывод свойсва файла.
// На форме разместите TOpenDialog (OpenDialog1) и TButton
// (Button1) напишите следующий обработчик события OnClick кнопки:
void __fastcall TForm1::Button1Click(TObject *Sender)
{
    if(OpenDialog1->Execute())
    {
        SHELLEXECUTEINFO SEI;
        ZeroMemory(&SEI, sizeof(SHELLEXECUTEINFO));
        SEI.cbSize= sizeof(SHELLEXECUTEINFO);
        SEI.lpVerb = "properties";
        SEI.lpFile= OpenDialog1->FileName.c_str();
        SEI.nShow = SW_SHOW;
        SEI.fMask= SEE_MASK_INVOKEIDLIST;
        ShellExecuteEx(&SEI);
    }
}

разрядноть системы.
typedef BOOL (WINAPI *IW64PFP)(HANDLE, BOOL *);
//---------------------------------------------------------------------------
int GetWindowsBitness()
{
  int result = 32;
  // ----
  // When this application is compiled as a 32-bit app,
  // and run on a native 64-bit system, Windows will run
  // this application under WOW64.  WOW64 is the Windows-
  // on-Windows subsystem that lets native 32-bit applications
  // run in 64-bit land.  This calls the kernel32.dll
  // API to see if this process is running under WOW64.
  // If it is running under WOW64, then that clearly means
  // this 32-bit application is running on a 64-bit OS,
  // and IsWow64Process will return true.
  IW64PFP IW64P = (IW64PFP)GetProcAddress(GetModuleHandle("kernel32"), "IsWow64Process");
  //
  if(IW64P != NULL)
  {
    bool bStatus = false;
    IW64P(GetCurrentProcess(), &bStatus);
    result = (bStatus) ? 64 : 32;
  }
  return result;
}